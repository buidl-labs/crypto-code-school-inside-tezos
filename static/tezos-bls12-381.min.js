var Bls12=function(){"use strict";var e="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function t(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}var r=t,a=n;function i(e){if(r===setTimeout)return setTimeout(e,0);if((r===t||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}"function"==typeof e.setTimeout&&(r=setTimeout),"function"==typeof e.clearTimeout&&(a=clearTimeout);var f,u=[],c=!1,o=-1;function l(){c&&f&&(c=!1,f.length?u=f.concat(u):o=-1,u.length&&s())}function s(){if(!c){var e=i(l);c=!0;for(var t=u.length;t;){for(f=u,u=[];++o<t;)f&&f[o].run();o=-1,t=u.length}f=null,c=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===n||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}d.prototype.run=function(){this.fun.apply(null,this.array)};function b(){}var p=b,y=b,m=b,h=b,w=b,E=b,g=b;var x=e.performance||{},v=x.now||x.mozNow||x.msNow||x.oNow||x.webkitNow||function(){return(new Date).getTime()};var O=new Date;var R={nextTick:function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new d(e,t)),1!==u.length||c||i(s)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:p,addListener:y,once:m,off:h,removeListener:w,removeAllListeners:E,emit:g,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*v.call(x),n=Math.floor(t),r=Math.floor(t%1*1e9);return e&&(n-=e[0],(r-=e[1])<0&&(n--,r+=1e9)),[n,r]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-O)/1e3}};function q(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})})),t}function F(e){var t={exports:{}};return e(t,t.exports),t.exports}var P=F((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isogenyCoefficients=t.psi2=t.psi=t.millerLoop=t.calcPairingPrecomputes=t.isogenyMapG2=t.map_to_curve_SSWU_G2=t.ProjectivePoint=t.Fq12=t.Fq6=t.Fq2=t.Fr=t.Fq=t.powMod=t.mod=t.DST_LABEL=t.CURVE=void 0,t.CURVE={P:0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn,r:0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n,h:0x396c8c005555e1568c00aaab0000aaabn,Gx:0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bbn,Gy:0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1n,b:4n,P2:0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn**2n-1n,h2:0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5n,G2x:[0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8n,0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7en],G2y:[0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801n,0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79ben],b2:[4n,4n],x:0xd201000000010000n,h_eff:0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551n},t.DST_LABEL="BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_";const n=i(t.CURVE.x);function r(e,t){const n=e%t;return n>=0n?n:t+n}function a(e,t,n){let a=1n;for(;t>0n;)1n&t&&(a=r(a*e,n)),t>>=1n,e=r(e*e,n);return a}function i(e){let t;for(t=0;e>0n;e>>=1n,t+=1);return t}function f(e,t){return e>>BigInt(t)&1n}t.mod=r,t.powMod=a;class u{constructor(e){this.value=r(e,u.ORDER)}isZero(){return 0n===this.value}equals(e){return this.value===e.value}negate(){return new u(-this.value)}invert(){let e,[t,n,r,a]=[1n,0n,0n,1n],i=u.ORDER,f=this.value;for(;0n!==i;)[e,f,i]=[f/i,i,f%i],[t,n]=[n,t-e*n],[r,a]=[a,r-e*a];return new u(t)}add(e){return new u(this.value+e.value)}square(){return new u(this.value*this.value)}pow(e){return new u(a(this.value,e,u.ORDER))}subtract(e){return new u(this.value-e.value)}multiply(e){return e instanceof u&&(e=e.value),new u(this.value*e)}div(e){const t="bigint"==typeof e?new u(e).invert().value:e.invert();return this.multiply(t)}toString(){const e=this.value.toString(16).padStart(96,"0");return e.slice(0,2)+"."+e.slice(-2)}}t.Fq=u,u.ORDER=t.CURVE.P,u.MAX_BITS=i(t.CURVE.P),u.ZERO=new u(0n),u.ONE=new u(1n);class c{constructor(e){this.value=r(e,c.ORDER)}static isValid(e){return e<=c.ORDER}isZero(){return 0n===this.value}equals(e){return this.value===e.value}negate(){return new c(-this.value)}invert(){let e,[t,n,r,a]=[1n,0n,0n,1n],i=c.ORDER,f=this.value;for(;0n!==i;)[e,f,i]=[f/i,i,f%i],[t,n]=[n,t-e*n],[r,a]=[a,r-e*a];return new c(t)}add(e){return new c(this.value+e.value)}square(){return new c(this.value*this.value)}pow(e){return new c(a(this.value,e,c.ORDER))}subtract(e){return new c(this.value-e.value)}multiply(e){return e instanceof c&&(e=e.value),new c(this.value*e)}div(e){const t="bigint"==typeof e?new c(e).invert().value:e.invert();return this.multiply(t)}legendre(){return this.pow((c.ORDER-1n)/2n)}sqrt(){if(!this.legendre().equals(c.ONE))return;const e=c.ORDER;let t,n,i;for(t=e-1n,n=0;t%2n==0n;t/=2n,n++);if(1==n)return this.pow((e+1n)/4n);for(i=2n;i<e&&new c(i).legendre().value!=e-1n;i++);let f=a(i,t,e),u=a(this.value,(t+1n)/2n,e),o=a(this.value,t,e),l=0n;for(;0n!=r(o-1n,e);){let t;for(l=r(o*o,e),t=1;t<n&&0n!=r(l-1n,e);t++)l=r(l*l,e);let i=a(f,BigInt(1<<n-t-1),e);u=r(u*i,e),f=r(i*i,e),o=r(o*f,e),n=t}return new c(u)}toString(){return"0x"+this.value.toString(16).padStart(64,"0")}}t.Fr=c,c.ORDER=t.CURVE.r,c.ZERO=new c(0n),c.ONE=new c(1n);class o{zip(e,t){const n=this.c,r=e.c,a=[];for(let e=0;e<n.length;e++)a.push(t(n[e],r[e]));return a}map(e){return this.c.map(e)}isZero(){return this.c.every((e=>e.isZero()))}equals(e){return this.zip(e,((e,t)=>e.equals(t))).every((e=>e))}negate(){return this.init(this.map((e=>e.negate())))}add(e){return this.init(this.zip(e,((e,t)=>e.add(t))))}subtract(e){return this.init(this.zip(e,((e,t)=>e.subtract(t))))}conjugate(){return this.init([this.c[0],this.c[1].negate()])}one(){const e=this;let t;return e instanceof y&&(t=y.ONE),e instanceof m&&(t=m.ONE),e instanceof h&&(t=h.ONE),t}pow(e){const t=this.one();if(0n===e)return t;if(1n===e)return this;let n=t,r=this;for(;e>0n;)1n&e&&(n=n.multiply(r)),e>>=1n,r=r.square();return n}div(e){const t="bigint"==typeof e?new u(e).invert().value:e.invert();return this.multiply(t)}}const l=0x6af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09n,s=0x699be3b8c6870965e5bf892ad5d2cc7b0e85a117402dfd83b7f4a947e02d978498255a2aaec0ac627b5afbdf1bf1c90n,d=0x8157cd83046453f5dd0972b6e3949e4288020b5b8a9cc99ca07e27089a2ce2436d965026adad3ef7baba37f2183e9b5n,b=0xab1c2ffdd6c253ca155231eb3e71ba044fd562f6f72bc5bad5ec46a0b7a3b0247cf08ce6c6317f40edbc653a72dee17n,p=0xaa404866706722864480885d68ad0ccac1967c7544b447873cc37e0181271e006df72162a3d3e0287bf597fbf7f8fc1n;class y extends o{constructor(e){if(super(),2!==e.length)throw new Error("Expected array with 2 elements");e.forEach(((t,n)=>{"bigint"==typeof t&&(e[n]=new u(t))})),this.c=e}init(e){return new y(e)}toString(){return`Fq2(${this.c[0]} + ${this.c[1]}Ã—i)`}get values(){return this.c.map((e=>e.value))}multiply(e){if("bigint"==typeof e)return new y(this.map((t=>t.multiply(e))));const[t,n]=this.c,[r,a]=e.c;let i=t.multiply(r),f=n.multiply(a);return new y([i.subtract(f),t.add(n).multiply(r.add(a)).subtract(i.add(f))])}mulByNonresidue(){const e=this.c[0],t=this.c[1];return new y([e.subtract(t),e.add(t)])}square(){const e=this.c[0],t=this.c[1],n=e.add(t),r=e.subtract(t),a=e.add(e);return new y([n.multiply(r),a.multiply(t)])}sqrt(){const e=this.pow((y.ORDER+8n)/16n),t=e.square().div(this),n=y.ROOTS_OF_UNITY,r=[n[0],n[2],n[4],n[6]].find((e=>e.equals(t)));if(!r)return;const a=n.indexOf(r),i=n[a/2];if(!i)throw new Error("Invalid root");const f=e.div(i),u=f.negate(),[c,o]=f.values,[l,s]=u.values;return o>s||o==s&&c>l?f:u}invert(){const[e,t]=this.values,n=new u(e*e+t*t).invert();return new y([n.multiply(new u(e)),n.multiply(new u(-t))])}frobeniusMap(e){return new y([this.c[0],this.c[1].multiply(y.FROBENIUS_COEFFICIENTS[e%2])])}multiplyByB(){let[e,t]=this.c,n=e.multiply(4n),r=t.multiply(4n);return new y([n.subtract(r),n.add(r)])}}t.Fq2=y,y.ORDER=t.CURVE.P2,y.MAX_BITS=i(t.CURVE.P2),y.ROOT=new u(-1n),y.ZERO=new y([0n,0n]),y.ONE=new y([1n,0n]),y.COFACTOR=t.CURVE.h2,y.ROOTS_OF_UNITY=[new y([1n,0n]),new y([l,-l]),new y([0n,1n]),new y([l,l]),new y([-1n,0n]),new y([-l,l]),new y([0n,-1n]),new y([-l,-l])],y.ETAs=[new y([s,d]),new y([-d,s]),new y([b,p]),new y([-p,b])],y.FROBENIUS_COEFFICIENTS=[new u(0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001n),new u(0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaan)];class m extends o{constructor(e){if(super(),this.c=e,3!==e.length)throw new Error("Expected array with 2 elements")}static fromTuple(e){return new m([new y(e.slice(0,2)),new y(e.slice(2,4)),new y(e.slice(4,6))])}init(e){return new m(e)}toString(){return`Fq6(${this.c[0]} + ${this.c[1]} * v, ${this.c[2]} * v^2)`}conjugate(){throw new TypeError("No conjugate on Fq6")}multiply(e){if("bigint"==typeof e)return new m([this.c[0].multiply(e),this.c[1].multiply(e),this.c[2].multiply(e)]);let[t,n,r]=this.c;const[a,i,f]=e.c;let u=t.multiply(a),c=n.multiply(i),o=r.multiply(f);return new m([u.add(n.add(r).multiply(i.add(f)).subtract(c.add(o)).mulByNonresidue()),t.add(n).multiply(a.add(i)).subtract(u.add(c)).add(o.mulByNonresidue()),c.add(t.add(r).multiply(a.add(f)).subtract(u.add(o)))])}mulByNonresidue(){return new m([this.c[2].mulByNonresidue(),this.c[0],this.c[1]])}multiplyBy1(e){return new m([this.c[2].multiply(e).mulByNonresidue(),this.c[0].multiply(e),this.c[1].multiply(e)])}multiplyBy01(e,t){let[n,r,a]=this.c,i=n.multiply(e),f=r.multiply(t);return new m([r.add(a).multiply(t).subtract(f).mulByNonresidue().add(i),e.add(t).multiply(n.add(r)).subtract(i).subtract(f),n.add(a).multiply(e).subtract(i).add(f)])}multiplyByFq2(e){return new m(this.map((t=>t.multiply(e))))}square(){let[e,t,n]=this.c,r=e.square(),a=e.multiply(t).multiply(2n),i=t.multiply(n).multiply(2n),f=n.square();return new m([i.mulByNonresidue().add(r),f.mulByNonresidue().add(a),a.add(e.subtract(t).add(n).square()).add(i).subtract(r).subtract(f)])}invert(){let[e,t,n]=this.c,r=e.square().subtract(n.multiply(t).mulByNonresidue()),a=n.square().mulByNonresidue().subtract(e.multiply(t)),i=t.square().subtract(e.multiply(n)),f=n.multiply(a).add(t.multiply(i)).mulByNonresidue().add(e.multiply(r)).invert();return new m([f.multiply(r),f.multiply(a),f.multiply(i)])}frobeniusMap(e){return new m([this.c[0].frobeniusMap(e),this.c[1].frobeniusMap(e).multiply(m.FROBENIUS_COEFFICIENTS_1[e%6]),this.c[2].frobeniusMap(e).multiply(m.FROBENIUS_COEFFICIENTS_2[e%6])])}}t.Fq6=m,m.ZERO=new m([y.ZERO,y.ZERO,y.ZERO]),m.ONE=new m([y.ONE,y.ZERO,y.ZERO]),m.FROBENIUS_COEFFICIENTS_1=[new y([0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001n,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new y([0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n,0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn]),new y([0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new y([0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001n]),new y([0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new y([0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n,0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen])],m.FROBENIUS_COEFFICIENTS_2=[new y([0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001n,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new y([0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaadn,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new y([0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new y([0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaan,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new y([0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new y([0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffeffffn,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n])];class h extends o{constructor(e){if(super(),this.c=e,2!==e.length)throw new Error("Expected array with 2 elements")}static fromTuple(e){return new h([m.fromTuple(e.slice(0,6)),m.fromTuple(e.slice(6,12))])}init(e){return new h(e)}toString(){return`Fq12(${this.c[0]} + ${this.c[1]} * w)`}multiply(e){if("bigint"==typeof e)return new h([this.c[0].multiply(e),this.c[1].multiply(e)]);let[t,n]=this.c;const[r,a]=e.c;let i=t.multiply(r),f=n.multiply(a);return new h([i.add(f.mulByNonresidue()),t.add(n).multiply(r.add(a)).subtract(i.add(f))])}multiplyBy014(e,t,n){let[r,a]=this.c,[i,f]=[r.multiplyBy01(e,t),a.multiplyBy1(n)];return new h([f.mulByNonresidue().add(i),a.add(r).multiplyBy01(e,t.add(n)).subtract(i).subtract(f)])}multiplyByFq2(e){return this.init(this.map((t=>t.multiplyByFq2(e))))}square(){let[e,t]=this.c,n=e.multiply(t);return new h([t.mulByNonresidue().add(e).multiply(e.add(t)).subtract(n).subtract(n.mulByNonresidue()),n.add(n)])}invert(){let[e,t]=this.c,n=e.square().subtract(t.square().mulByNonresidue()).invert();return new h([e.multiply(n),t.multiply(n).negate()])}frobeniusMap(e){const[t,n]=this.c;let r=t.frobeniusMap(e),[a,i,f]=n.frobeniusMap(e).c;return new h([r,new m([a.multiply(h.FROBENIUS_COEFFICIENTS[e%12]),i.multiply(h.FROBENIUS_COEFFICIENTS[e%12]),f.multiply(h.FROBENIUS_COEFFICIENTS[e%12])])])}Fq4Square(e,t){const n=e.square(),r=t.square();return[r.mulByNonresidue().add(n),e.add(t).square().subtract(n).subtract(r)]}cyclotomicSquare(){const[e,t]=this.c,[n,r,a]=e.c,[i,f,u]=t.c;let[c,o]=this.Fq4Square(n,f),[l,s]=this.Fq4Square(i,a),[d,b]=this.Fq4Square(r,u),p=b.mulByNonresidue();return new h([new m([c.subtract(n).multiply(2n).add(c),l.subtract(r).multiply(2n).add(l),d.subtract(a).multiply(2n).add(d)]),new m([p.add(i).multiply(2n).add(p),o.add(f).multiply(2n).add(o),s.add(u).multiply(2n).add(s)])])}cyclotomicExp(e){let t=h.ONE;for(let r=n-1;r>=0;r--)t=t.cyclotomicSquare(),f(e,r)&&(t=t.multiply(this));return t}finalExponentiate(){let e=this.frobeniusMap(6).div(this),n=e.frobeniusMap(2).multiply(e),r=n.cyclotomicExp(t.CURVE.x).conjugate(),a=n.cyclotomicSquare().conjugate().multiply(r),i=a.cyclotomicExp(t.CURVE.x).conjugate(),f=i.cyclotomicExp(t.CURVE.x).conjugate(),u=f.cyclotomicExp(t.CURVE.x).conjugate().multiply(r.cyclotomicSquare());return r.multiply(f).frobeniusMap(2).multiply(i.multiply(n).frobeniusMap(3)).multiply(u.multiply(n.conjugate()).frobeniusMap(1)).multiply(u.cyclotomicExp(t.CURVE.x).conjugate()).multiply(a.conjugate()).multiply(n)}}t.Fq12=h,h.ZERO=new h([m.ZERO,m.ZERO]),h.ONE=new h([m.ONE,m.ZERO]),h.FROBENIUS_COEFFICIENTS=[new y([0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001n,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new y([0x1904d3bf02bb0667c231beb4202c0d1f0fd603fd3cbd5f4f7b2443d784bab9c4f67ea53d63e7813d8d0775ed92235fb8n,0x00fc3e2b36c4e03288e9e902231f9fb854a14787b6c7b36fec0c8ec971f63c5f282d5ac14d6c7ec22cf78a126ddc4af3n]),new y([0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffeffffn,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new y([0x135203e60180a68ee2e9c448d77a2cd91c3dedd930b1cf60ef396489f61eb45e304466cf3e67fa0af1ee7b04121bdea2n,0x06af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09n]),new y([0x00000000000000005f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffen,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new y([0x144e4211384586c16bd3ad4afa99cc9170df3560e77982d0db45f3536814f0bd5871c1908bd478cd1ee605167ff82995n,0x05b2cfd9013a5fd8df47fa6b48b1e045f39816240c0b8fee8beadf4d8e9c0566c63a3e6e257f87329b18fae980078116n]),new y([0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaaan,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new y([0x00fc3e2b36c4e03288e9e902231f9fb854a14787b6c7b36fec0c8ec971f63c5f282d5ac14d6c7ec22cf78a126ddc4af3n,0x1904d3bf02bb0667c231beb4202c0d1f0fd603fd3cbd5f4f7b2443d784bab9c4f67ea53d63e7813d8d0775ed92235fb8n]),new y([0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new y([0x06af0e0437ff400b6831e36d6bd17ffe48395dabc2d3435e77f76e17009241c5ee67992f72ec05f4c81084fbede3cc09n,0x135203e60180a68ee2e9c448d77a2cd91c3dedd930b1cf60ef396489f61eb45e304466cf3e67fa0af1ee7b04121bdea2n]),new y([0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaadn,0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000n]),new y([0x05b2cfd9013a5fd8df47fa6b48b1e045f39816240c0b8fee8beadf4d8e9c0566c63a3e6e257f87329b18fae980078116n,0x144e4211384586c16bd3ad4afa99cc9170df3560e77982d0db45f3536814f0bd5871c1908bd478cd1ee605167ff82995n])];function w(e){const[t,n]=e.values;return BigInt(t%2n||0n===t&&n%2n)}t.ProjectivePoint=class{constructor(e,t,n,r){this.x=e,this.y=t,this.z=n,this.C=r}isZero(){return this.z.isZero()}getPoint(e,t,n){return new this.constructor(e,t,n)}getZero(){return this.getPoint(this.C.ONE,this.C.ONE,this.C.ZERO)}equals(e){if(this.constructor!=e.constructor)throw new Error(`ProjectivePoint#equals: this is ${this.constructor}, but rhs is ${e.constructor}`);const t=this,n=e,r=t.x.multiply(n.z).equals(n.x.multiply(t.z)),a=t.y.multiply(n.z).equals(n.y.multiply(t.z));return r&&a}negate(){return this.getPoint(this.x,this.y.negate(),this.z)}toString(e=!0){if(!e)return`Point<x=${this.x}, y=${this.y}, z=${this.z}>`;const[t,n]=this.toAffine();return`Point<x=${t}, y=${n}>`}fromAffineTuple(e){return this.getPoint(e[0],e[1],this.C.ONE)}toAffine(e=this.z.invert()){return[this.x.multiply(e),this.y.multiply(e)]}toAffineBatch(e){const t=function(e,t){const n=t.length,r=new Array(n);let a=e.ONE;for(let e=0;e<n;e++)t[e].isZero()||(r[e]=a,a=a.multiply(t[e]));a=a.invert();for(let e=n-1;e>=0;e--){if(t[e].isZero())continue;let n=a.multiply(t[e]);t[e]=a.multiply(r[e]),a=n}return t}(this.C,e.map((e=>e.z)));return e.map(((e,n)=>e.toAffine(t[n])))}normalizeZ(e){return this.toAffineBatch(e).map((e=>this.fromAffineTuple(e)))}double(){const{x:e,y:t,z:n}=this,r=e.multiply(e).multiply(3n),a=t.multiply(n),i=a.multiply(a),f=i.multiply(a),u=e.multiply(t).multiply(a),c=r.multiply(r).subtract(u.multiply(8n)),o=c.multiply(a).multiply(2n),l=r.multiply(u.multiply(4n).subtract(c)).subtract(t.multiply(t).multiply(8n).multiply(i)),s=f.multiply(8n);return this.getPoint(o,l,s)}add(e){if(this.constructor!=e.constructor)throw new Error(`ProjectivePoint#add: this is ${this.constructor}, but rhs is ${e.constructor}`);const t=this,n=e;if(t.isZero())return n;if(n.isZero())return t;const r=t.x,a=t.y,i=t.z,f=n.x,u=n.y,c=n.z,o=u.multiply(i),l=a.multiply(c),s=f.multiply(i),d=r.multiply(c);if(s.equals(d)&&o.equals(l))return this.double();if(s.equals(d))return this.getZero();const b=o.subtract(l),p=s.subtract(d),y=p.multiply(p),m=y.multiply(p),h=d.multiply(y),w=i.multiply(c),E=b.multiply(b).multiply(w).subtract(m).subtract(h.multiply(2n)),g=p.multiply(E),x=b.multiply(h.subtract(E)).subtract(m.multiply(l)),v=m.multiply(w);return this.getPoint(g,x,v)}subtract(e){if(this.constructor!=e.constructor)throw new Error(`ProjectivePoint#subtract: this is ${this.constructor}, but rhs is ${e.constructor}`);return this.add(e.negate())}multiplyUnsafe(e){let t=e;if(t instanceof u&&(t=t.value),"number"==typeof t&&(t=BigInt(t)),t<=0)throw new Error("Point#multiply: invalid scalar, expected positive integer");let n=this.getZero(),r=this;for(;t>0n;)1n&t&&(n=n.add(r)),r=r.double(),t>>=1n;return n}maxBits(){return this.C.MAX_BITS}precomputeWindow(e){const t=Math.ceil(this.maxBits()/e),n=2**(e-1);let r=[],a=this,i=a;for(let e=0;e<t;e++){i=a,r.push(i);for(let e=1;e<n;e++)i=i.add(a),r.push(i);a=i.double()}return r}calcMultiplyPrecomputes(e){if(this._MPRECOMPUTES)throw new Error("This point already has precomputes");this._MPRECOMPUTES=[e,this.normalizeZ(this.precomputeWindow(e))]}clearMultiplyPrecomputes(){this._MPRECOMPUTES=void 0}wNAF(e){let t,n;this._MPRECOMPUTES?[t,n]=this._MPRECOMPUTES:(t=1,n=this.precomputeWindow(t));let[r,a]=[this.getZero(),this.getZero()];const i=Math.ceil(this.maxBits()/t),f=2**(t-1),u=BigInt(2**t-1),c=2**t,o=BigInt(t);for(let t=0;t<i;t++){const i=t*f;let l=Number(e&u);if(e>>=o,l>f&&(l-=c,e+=1n),0===l)a=a.add(t%2?n[i].negate():n[i]);else{const e=n[i+Math.abs(l)-1];r=r.add(l<0?e.negate():e)}}return[r,a]}multiply(e){let t=e;if(t instanceof u&&(t=t.value),"number"==typeof t&&(t=BigInt(t)),t<=0)throw new Error("ProjectivePoint#multiply: invalid scalar, expected positive integer");if(i(t)>this.maxBits())throw new Error("ProjectivePoint#multiply: scalar has more bits than maxBits, shoulnd't happen");return this.wNAF(t)[0]}};const E=(t.CURVE.P**2n-9n)/16n;t.map_to_curve_SSWU_G2=function(e){const t=new y([0n,240n]),n=new y([1012n,1012n]),r=new y([-2n,-1n]);Array.isArray(e)&&(e=new y(e));const a=e.pow(2n),i=r.multiply(a),f=i.add(i.pow(2n));let u=t.multiply(f).negate(),c=n.multiply(f.add(y.ONE));u.isZero()&&(u=r.multiply(t));let o=u.pow(3n),l=c.pow(3n).add(t.multiply(c).multiply(u.pow(2n))).add(n.multiply(o));const[s,d]=function(e,t){const n=e.multiply(t.pow(7n)),r=n.multiply(t.pow(8n)).pow(E).multiply(n);let a=!1,i=r;const f=y.ROOTS_OF_UNITY.slice(0,4);for(const n of f){const f=n.multiply(r);f.pow(2n).multiply(t).subtract(e).isZero()&&!a&&(a=!0,i=f)}return[a,i]}(l,o);let b;s&&(b=d);const p=d.multiply(e.pow(3n));l=i.pow(3n).multiply(l);let m=!1;for(const e of y.ETAs){const t=e.multiply(p);!t.pow(2n).multiply(o).subtract(l).isZero()||s||m||(b=t,m=!0)}if(!s&&!m)throw new Error("Hash to Curve - Optimized SWU failure");return m&&(c=c.multiply(i)),b=b,w(e)!==w(b)&&(b=b.negate()),b=b.multiply(u),[c,b,u]},t.isogenyMapG2=function(e){const[n,r,a]=e,i=[y.ZERO,y.ZERO,y.ZERO,y.ZERO],f=[a,a.pow(2n),a.pow(3n)];for(let e=0;e<t.isogenyCoefficients.length;e++){const r=t.isogenyCoefficients[e];i[e]=r.slice(-1)[0];const a=r.slice(0,-1).reverse();for(let t=0;t<a.length;t++){const r=a[t];i[e]=i[e].multiply(n).add(f[t].multiply(r))}}i[2]=i[2].multiply(r),i[3]=i[3].multiply(a);const u=i[1].multiply(i[3]);return[i[0].multiply(i[3]),i[1].multiply(i[2]),u]},t.calcPairingPrecomputes=function(e,r){const[a,i,u]=[e,r,y.ONE];let[c,o,l]=[a,i,u],s=[];for(let e=n-2;e>=0;e--){let n=o.square(),r=l.square(),u=r.multiply(3n).multiplyByB(),d=u.multiply(3n),b=o.add(l).square().subtract(r).subtract(n);if(s.push([u.subtract(n),c.square().multiply(3n),b.negate()]),c=n.subtract(d).multiply(c).multiply(o).div(2n),o=n.add(d).div(2n).square().subtract(u.square().multiply(3n)),l=n.multiply(b),f(t.CURVE.x,e)){let e=o.subtract(i.multiply(l)),t=c.subtract(a.multiply(l));s.push([e.multiply(a).subtract(t.multiply(i)),e.negate(),t]);let n=t.square(),r=n.multiply(t),f=n.multiply(c),u=r.subtract(f.multiply(2n)).add(e.square().multiply(l));c=t.multiply(u),o=f.subtract(u).multiply(e).subtract(r.multiply(o)),l=l.multiply(r)}}return s},t.millerLoop=function(e,r){let a=h.ONE;const[i,u]=r,[c,o]=[i,u];for(let r=0,i=n-2;i>=0;i--,r++)a=a.multiplyBy014(e[r][0],e[r][1].multiply(c.value),e[r][2].multiply(o.value)),f(t.CURVE.x,i)&&(r+=1,a=a.multiplyBy014(e[r][0],e[r][1].multiply(c.value),e[r][2].multiply(o.value))),0!=i&&(a=a.square());return a.conjugate()};const g=new m([y.ZERO,y.ONE,y.ZERO]),x=new h([g,m.ZERO]),v=x.invert(),O=new h([m.ZERO,g]),R=O.invert();t.psi=function(e,t){return[v.multiplyByFq2(e).frobeniusMap(1).multiply(x).c[0].c[0],R.multiplyByFq2(t).frobeniusMap(1).multiply(O).c[0].c[0]]};const q=0x1a0111ea397fe699ec02408663d4de85aa0d857d89759ad4897d29650fb85f9b409427eb4f49fffd8bfd00000000aaacn;t.psi2=function(e,t){return[e.multiply(q),t.negate()]};const F=[new y([0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6n,0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6n]),new y([0x0n,0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71an]),new y([0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71en,0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38dn]),new y([0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1n,0x0n])],P=[new y([0x0n,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63n]),new y([0xcn,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9fn]),y.ONE,y.ZERO],S=[new y([0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706n,0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706n]),new y([0x0n,0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97ben]),new y([0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71cn,0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38fn]),new y([0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10n,0x0n])],B=[new y([0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fbn,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fbn]),new y([0x0n,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3n]),new y([0x12n,0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99n]),new y([0x1n,0x0n])];t.isogenyCoefficients=[F,P,S,B]})),S=q(Object.freeze({__proto__:null,default:{}})),B=F((function(e,t){
/*! noble-bls12-381 - MIT License (c) Paul Miller (paulmillr.com) */
Object.defineProperty(t,"__esModule",{value:!0}),t.verifyBatch=t.aggregateSignatures=t.aggregatePublicKeys=t.verify=t.sign=t.getPublicKey=t.pairing=t.PointG2=t.clearCofactorG2=t.PointG1=t.hash_to_field=t.utils=t.CURVE=t.Fq12=t.Fq2=t.Fr=t.Fq=t.DST_LABEL=void 0,Object.defineProperty(t,"Fq",{enumerable:!0,get:function(){return P.Fq}}),Object.defineProperty(t,"Fr",{enumerable:!0,get:function(){return P.Fr}}),Object.defineProperty(t,"Fq2",{enumerable:!0,get:function(){return P.Fq2}}),Object.defineProperty(t,"Fq12",{enumerable:!0,get:function(){return P.Fq12}}),Object.defineProperty(t,"CURVE",{enumerable:!0,get:function(){return P.CURVE}});const n=P.CURVE.P;t.DST_LABEL="BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_";const r=2n**381n,a=2n*r,i=2n*a,f=48,u=32n;function c(e){return BigInt(`0x${e}`)}function o(e){if("string"==typeof e){if(!/^[a-fA-F0-9]*$/.test(e))throw new Error("expected hex string or Uint8Array");return c(e)}let t=0n;for(let n=e.length-1,r=0;n>=0;n--,r++)t+=(255n&BigInt(e[n]))<<8n*BigInt(r);return t}function l(e){let t="";for(let n=0;n<e.length;n++)t+=e[n].toString(16).padStart(2,"0");return t}t.utils={async sha256(e){if("object"==typeof window&&"crypto"in window){const t=await window.crypto.subtle.digest("SHA-256",e.buffer);return new Uint8Array(t)}if("object"==typeof R&&"node"in R.versions){const{createHash:t}=S,n=t("sha256");return n.update(e),Uint8Array.from(n.digest())}throw new Error("The environment doesn't have sha256 function")},randomPrivateKey:(e=32)=>{if("object"==typeof window&&"crypto"in window)return window.crypto.getRandomValues(new Uint8Array(e));if("object"==typeof R&&"node"in R.versions){const{randomBytes:t}=S;return new Uint8Array(t(e).buffer)}throw new Error("The environment doesn't have randomBytes function")},mod:P.mod};const s={};for(let e=0;e<256;e++)s[e.toString(16).padStart(2,"0")]=e;function d(e,t=0){let n="string"==typeof e?e.toLowerCase():e.toString(16);if(!n.length&&!t)return new Uint8Array([]);1&n.length&&(n=`0${n}`);const r=n.length,a=new Uint8Array(r/2);for(let e=0,t=0;e<r-1;e+=2,t++){const r=n[e]+n[e+1],i=s[r];if(null==i)throw new Error(`expected hex string or Uint8Array, got ${n}`);a[t]=i}return function(e,t,n){if(e.length>=t)return e;const r=t-e.length,a=Array(r).fill(n).map((e=>e));return b(new Uint8Array(a),e)}(a,t,0)}function b(...e){return new Uint8Array(e.reduce(((e,t)=>(t=t instanceof Uint8Array?t:d(t),[...e,...t])),[]))}function p(e){let t=0n;for(let n=0;n<e.length;n++)t<<=8n,t+=BigInt(e[n]);return t}function y(e,t){if(e<0||e>=1<<8*t)throw new Error(`bad I2OSP call: value=${e} length=${t}`);const n=Array.from({length:t}).fill(0);for(let r=t-1;r>=0;r--)n[r]=255&e,e>>>=8;return new Uint8Array(n)}function m(e,t){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e[r]^t[r];return n}async function h(e,n,r=!0){const a=r?2:1,i=n,f=a*i*64,c=function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(t.DST_LABEL),o=await async function(e,n,r){const a=t.utils.sha256,i=Number(u),f=2*i,c=Math.ceil(r/i);if(c>255)throw new Error("Invalid xmd length");const o=b(n,y(n.length,1)),l=y(0,f),s=y(r,2),d=new Array(c),p=await a(b(l,e,s,y(0,1),o));d[0]=await a(b(p,y(1,1),o));for(let e=1;e<=c;e++){const t=[m(p,d[e-1]),y(e+1,1),o];d[e]=await a(b(...t))}return b(...d).slice(0,r)}(e,c,f),l=new Array(a);for(let e=0;e<a;e++){const t=new Array(i);for(let n=0;n<i;n++){const r=64*(n+e*i),a=o.slice(r,r+64);t[n]=P.mod(p(a),P.CURVE.P)}l[e]=t}return l}function w(e){const t=new P.Fq("string"==typeof(n=e)?c(n):"number"==typeof n?BigInt(n):n instanceof Uint8Array?o(n):n);var n;if(t.isZero())throw new Error("Private key cannot be 0");return t}t.hash_to_field=h;class E extends P.ProjectivePoint{constructor(e,t,n){super(e,t,n,P.Fq)}static fromHex(e){let t;if("string"==typeof e&&(e=d(e)),48===e.length){const f=o(e);if(1n===P.mod(f,i)/a)return this.ZERO;const u=P.mod(f,r),c=P.mod(u**3n+new P.Fq(P.CURVE.b).value,n);let l=P.powMod(c,(n+1n)/4n,n);if(P.powMod(l,2n,n)-c!==0n)throw new Error("The given point is not on G1: y**2 = x**3 + b");const s=P.mod(f,a)/r;2n*l/n!==s&&(l=n-l),t=new E(new P.Fq(u),new P.Fq(l),new P.Fq(1n))}else{if(96!==e.length)throw new Error("Invalid point G1, expected 48/96 bytes");{if(0!=(64&e[0]))return E.ZERO;const n=o(e.slice(0,f)),r=o(e.slice(f));t=new E(new P.Fq(n),new P.Fq(r),P.Fq.ONE)}}return t.assertValidity(),t}static fromPrivateKey(e){return this.BASE.multiply(w(e))}toRawBytes(e=!1){if(e){let e;if(this.equals(E.ZERO))e=i+a;else{const[t,a]=this.toAffine(),f=2n*a.value/n;e=t.value+f*r+i}return d(e,f)}if(this.equals(E.ZERO)){const e=new Uint8Array(96);return e[0]|=64,e}{const[e,t]=this.toAffine();return new Uint8Array([...d(e.value,f),...d(t.value,f)])}}toHex(e=!1){return l(this.toRawBytes(e))}assertValidity(){const e=new P.Fq(P.CURVE.b);if(this.isZero())return;const{x:t,y:n,z:r}=this,a=n.pow(2n).multiply(r).subtract(t.pow(3n)),i=e.multiply(r.pow(3n));if(!a.equals(i))throw new Error("Invalid point: not on curve over Fq")}toRepr(){return[this.x,this.y,this.z].map((e=>e.value))}millerLoop(e){return P.millerLoop(e.pairingPrecomputes(),this.toAffine())}}function g(e){const t=e.multiplyUnsafe(P.CURVE.x).negate(),n=e.fromAffineTuple(P.psi(...e.toAffine()));return e.fromAffineTuple(P.psi2(...e.double().toAffine())).subtract(n).add(t.add(n).multiplyUnsafe(P.CURVE.x).negate()).subtract(t).subtract(e)}t.PointG1=E,E.BASE=new E(new P.Fq(P.CURVE.Gx),new P.Fq(P.CURVE.Gy),P.Fq.ONE),E.ZERO=new E(P.Fq.ONE,P.Fq.ONE,P.Fq.ZERO),t.clearCofactorG2=g;class x extends P.ProjectivePoint{constructor(e,t,n){super(e,t,n,P.Fq2)}static async hashToCurve(e){if("string"==typeof e){if(!/^[a-fA-F0-9]*$/.test(e))throw new Error("expected hex string or Uint8Array");e=d(e)}if(!(e instanceof Uint8Array))throw new Error("expected hex string or Uint8Array");const t=await h(e,2),n=new x(...P.isogenyMapG2(P.map_to_curve_SSWU_G2(t[0]))),r=new x(...P.isogenyMapG2(P.map_to_curve_SSWU_G2(t[1])));return g(n.add(r))}static fromSignature(e){const t=e.length/2;if(48!==t&&96!==t)throw new Error("invalid compressed signature length, must be 96 or 192");const f=o(e.slice(0,t)),u=o(e.slice(t));if(1n===P.mod(f,i)/a)return this.ZERO;const c=f%r,l=u,s=new P.Fq2([l,c]);let d=s.pow(3n).add(new P.Fq2(P.CURVE.b2)).sqrt();if(!d)throw new Error("Failed to find a square root");const[b,p]=d.values,y=f%a/r;(p>0n&&2n*p/n!==y||0n===p&&2n*b/n!==y)&&(d=d.multiply(-1n));const m=new x(s,d,P.Fq2.ONE);return m.assertValidity(),m}static fromHex(e){let t;if("string"==typeof e&&(e=d(e)),96===e.length)throw new Error("Compressed format not supported yet.");if(192!==e.length)throw new Error("Invalid uncompressed point G2, expected 192 bytes");{if(0!=(64&e[0]))return x.ZERO;const n=o(e.slice(0,f)),r=o(e.slice(f,96)),a=o(e.slice(96,144)),i=o(e.slice(144));t=new x(new P.Fq2([r,n]),new P.Fq2([i,a]),P.Fq2.ONE)}return t.assertValidity(),t}static fromPrivateKey(e){return this.BASE.multiply(w(e))}toSignature(){if(this.equals(x.ZERO)){return b(d(i+a,f),d(0n,f))}this.assertValidity();const[[e,t],[n,u]]=this.toAffine().map((e=>e.values)),c=e;return b(d(t+(u>0n?2n*u:2n*n)/P.CURVE.P*r+i,f),d(c,f))}toRawBytes(e=!1){if(e)throw new Error("Not supported");if(this.equals(x.ZERO)){const e=new Uint8Array(192);return e[0]|=64,e}{this.assertValidity();const[[e,t],[n,r]]=this.toAffine().map((e=>e.values));return new Uint8Array([...d(t,f),...d(e,f),...d(r,f),...d(n,f)])}}toHex(e=!1){return l(this.toRawBytes(e))}assertValidity(){const e=new P.Fq2(P.CURVE.b2);if(this.isZero())return;const{x:t,y:n,z:r}=this,a=n.pow(2n).multiply(r).subtract(t.pow(3n)),i=e.multiply(r.pow(3n));if(!a.equals(i))throw new Error("Invalid point: not on curve over Fq2")}toRepr(){return[this.x,this.y,this.z].map((e=>e.values))}clearPairingPrecomputes(){this._PPRECOMPUTES=void 0}pairingPrecomputes(){return this._PPRECOMPUTES||(this._PPRECOMPUTES=P.calcPairingPrecomputes(...this.toAffine())),this._PPRECOMPUTES}}function v(e,t,n=!0){if(e.isZero()||t.isZero())throw new Error("No pairings at point of Infinity");e.assertValidity(),t.assertValidity();const r=e.millerLoop(t);return n?r.finalExponentiate():r}function O(e){return e instanceof E?e:E.fromHex(e)}function q(e){return e instanceof x?e:x.fromSignature(e)}async function F(e){return e instanceof x?e:await x.hashToCurve(e)}t.PointG2=x,x.BASE=new x(new P.Fq2(P.CURVE.G2x),new P.Fq2(P.CURVE.G2y),P.Fq2.ONE),x.ZERO=new x(P.Fq2.ONE,P.Fq2.ONE,P.Fq2.ZERO),t.pairing=v,t.getPublicKey=function(e){const t=E.fromPrivateKey(e).toRawBytes(!0);return"string"==typeof e?l(t):t},t.sign=async function(e,t){const n=(await F(e)).multiply(w(t));if(e instanceof x)return n;const r=n.toSignature();return"string"==typeof e?l(r):r},t.verify=async function(e,t,n){const r=O(n),a=await F(t),i=E.BASE,f=q(e),u=v(r.negate(),a,!1);return v(i,f,!1).multiply(u).finalExponentiate().equals(P.Fq12.ONE)},t.aggregatePublicKeys=function(e){if(!e.length)throw new Error("Expected non-empty array");const t=e.map(O).reduce(((e,t)=>e.add(t)),E.ZERO);if(e[0]instanceof E)return t;const n=t.toRawBytes(!0);return e[0]instanceof Uint8Array?n:l(n)},t.aggregateSignatures=function(e){if(!e.length)throw new Error("Expected non-empty array");const t=e.map(q).reduce(((e,t)=>e.add(t)),x.ZERO);if(e[0]instanceof x)return t;const n=t.toSignature();return e[0]instanceof Uint8Array?n:l(n)},t.verifyBatch=async function(e,t,n){if(!t.length)throw new Error("Expected non-empty messages array");if(n.length!==t.length)throw new Error("Pubkey count should equal msg count");const r=await Promise.all(t.map(F)),a=n.map(O);try{const t=[];for(const e of new Set(r)){const n=r.reduce(((t,n,r)=>n===e?t.add(a[r]):t),E.ZERO);t.push(v(n,e,!1))}const n=q(e);t.push(v(E.BASE.negate(),n,!1));const i=t.reduce(((e,t)=>e.multiply(t)),P.Fq12.ONE);return i.finalExponentiate().equals(P.Fq12.ONE)}catch{return!1}},E.BASE.calcMultiplyPrecomputes(4)}));const U=e=>BigInt(`0x${e}`),N=e=>new B.Fr(U(e));return{addG1:(e,t)=>{const n=B.PointG1.fromHex(e),r=B.PointG1.fromHex(t);return n.assertValidity(),r.assertValidity(),n.add(r).toHex()},addG2:(e,t)=>{const n=B.PointG2.fromHex(e),r=B.PointG2.fromHex(t);return n.add(r).toHex()},addFr:(e,t)=>{const n=N(e),r=N(t);return n.add(r).value.toString(16)},multiplyG1ByFr:(e,t)=>{const n=B.PointG1.fromHex(e);return n.assertValidity(),n.multiply(U(t)).toHex()},multiplyG2ByFr:(e,t)=>B.PointG2.fromHex(e).multiply(U(t)).toHex(),multiplyFrByFr:(e,t)=>N(e).multiply(U(t)).value.toString(16),multiplyFrByInt:(e,t)=>N(e).multiply(BigInt(t)).value.toString(16),negateG1:e=>{const t=B.PointG1.fromHex(e).negate();return t.assertValidity(),t.toHex()},negateG2:e=>B.PointG2.fromHex(e).negate().toHex(),negateFr:e=>N(e).negate().value.toString(16),convertFrToInt:e=>N(e).value.toString(10),pairingCheck:e=>{let t=!0;if(e.length>0){const n=B.PointG1.fromHex(e[0][0]);n.assertValidity();const r=B.PointG2.fromHex(e[0][1]);r.assertValidity();const a=B.PointG1.fromHex(e[1][0]);a.assertValidity();const i=B.PointG2.fromHex(e[1][1]);i.assertValidity();const f=B.pairing(n,r),u=B.pairing(a,i);t=f.multiply(u).equals(B.Fq12.ONE)}return t}}}();